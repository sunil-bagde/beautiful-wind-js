Need to check proper implementation
max implementation is feel wrong
